<!doctype html>
<html amp lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
    <title>Asynchronous CSS: the easy way · A. M. Douglas · Leeds, UK</title>
    <link rel="manifest" href="https://amdouglas.com/manifest.json">
    <link rel="canonical" href="https://amdouglas.com/blog/asynchronous-css-the-easy-way/">
    <link rel="publisher" href="https://plus.google.com/+AMDouglasCom">
    <link rel="icon" href="https://amdouglas.com/favicon.ico">
    <meta name="format-detection" content="telephone=no;email=no">
    <meta name="MobileOptimized" content="width">
    <meta name="HandheldFriendly" content="true">
    <meta name="referrer" content="none-when-downgrade">
    <meta name="author" content="Adam Michael Douglas">
    <meta name="description" content="If you've ever looked into asynchronously handling fonts, you've probably read about FilamentGroup's method using link rel=preload, which might look like a hack, but this is actually what the preload spec is for...">
    <meta name="twitter:title" content="Asynchronous CSS: the easy way">
    <meta name="twitter:description" content="If you've ever looked into asynchronously handling fonts, you've probably read about FilamentGroup's method using link rel=preload, which might look like a hack, but this is actually what the preload spec is for...">
    <meta name="twitter:site" content="@amdgls">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="A. M. Douglas">
    <meta name="twitter:url" content="https://amdouglas.com/blog/amp/asynchronous-css-the-easy-way/">
    <meta name="twitter:domain" content="amdouglas.com">
    <meta name="twitter:image:src" content="https://amdouglas.com/assets/img/favicon-196x196.png">
    <meta name="twitter:image:alt" content="Blog &middot; A. M. Douglas">
    <meta property="fb:admins" content="407402372749613">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="A. M. Douglas">
    <meta property="og:title" content="Asynchronous CSS: the easy way">
    <meta property="og:description" content="If you've ever looked into asynchronously handling fonts, you've probably read about FilamentGroup's method using link rel=preload, which might look like a hack, but this is actually what the preload spec is for...">
    <meta property="og:locale" content="en_GB">
    <meta property="og:url" content="https://amdouglas.com/blog/amp/asynchronous-css-the-easy-way/">
    <meta property="og:image" content="https://amdouglas.com/assets/img/favicon-196x196.png">
    <meta property="og:image:secure_url" content="https://amdouglas.com/assets/img/favicon-196x196.png">
    <meta property="article:section" content="Web development">
    <meta property="article:publisher" content="https://www.facebook.com/amdgls">
    <meta property="article:tag" content="javascript,css,html5,js">
    <meta property="article:author" content="https://amdouglas.com/me/">
    <meta property="article:published_time" content="2016-09-30T23:32:46.000Z">
    <meta property="article:modified_time" content="2016-09-30T23:32:46.000Z">
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": "https://amdouglas.com/blog/amp/asynchronous-css-the-easy-way/",
        "headline": "Asynchronous CSS: the easy way",
        "datePublished": "2016-09-30T23:32:46+00:00",
        "dateModified": "2016-09-30T23:32:46+00:00",
        "description": "If you've ever looked into asynchronously handling fonts, you've probably read about FilamentGroup's method using link rel=preload, which might look like a hack, but this is actually what the preload spec is for...",
        "author": {
          "@type": "Person",
          "name": "A. M. Douglas"
        },
        "publisher": {
          "@type": "Organization",
          "name": "A. M. Douglas",
          "logo": {
            "@type": "ImageObject",
            "url": "https://amdouglas.com/assets/img/apple-touch-icon-60x60.png",
            "width": 60,
            "height": 60
          }
        },
        "image": {
          "@type": "ImageObject",
          "url": "https://amdouglas.com/assets/img/apple-touch-icon-60x60.png",
          "height": 60,
          "width": 60
        }
      }
    </script>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>
    <script async custom-element="amp-user-notification" src="https://cdn.ampproject.org/v0/amp-user-notification-0.1.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-install-serviceworker" src="https://cdn.ampproject.org/v0/amp-install-serviceworker-0.1.js"></script>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <style amp-custom>@font-face{font-family:'Rubik';font-style:normal;font-weight:400;font-display:fallback;src:local('Rubik'),local('Rubik-Regular'),url(https://amdouglas.com/assets/fonts/Rubik-Regular.woff2) format('woff2'),url(https://amdouglas.com/assets/fonts/Rubik-Regular.woff) format('woff')}@font-face{font-family:'Rubik';font-style:normal;font-weight:700;font-display:fallback;src:local('Rubik Bold'),local('Rubik-Bold'),url(https://amdouglas.com/assets/fonts/Rubik-Bold.woff2) format('woff2'),url(https://amdouglas.com/assets/fonts/Rubik-Bold.woff) format('woff')}html{-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased;-webkit-font-smoothing:subpixel-antialiased;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;touch-action:manipulation;font:normal normal 400 16px/1.2 Roboto,-apple-system,Arial,Helmet,Freesans,sans-serif}html,body{height:100%}*,:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;touch-action:manipulation;margin:0;padding:0;border:0;font:inherit}article,footer,header,main,nav,section{display:block}a{-webkit-text-decoration-skip:objects;text-decoration:none}a{-webkit-user-select:none;-moz-user-select:none}a{color:inherit;cursor:pointer}[disabled]{opacity:.6;cursor:not-allowed}[hidden]{display:none}::-webkit-scrollbar{width:4px}::-webkit-scrollbar-thumb{background:#07071c}::-webkit-scrollbar-track{background-color:transparent;background:rgba(0,0,0,0)}::selection{background:#07071c;color:#fff}.fonts-loaded{font-family:'Rubik',Roboto,-apple-system,Arial,Helvetica,sans-serif}body{position:relative;margin:0 auto;color:#07071c;background:#fff;z-index:1}main{margin:0 auto;max-width:720px;padding:56px 16px 16px;position:relative;z-index:2;background-color:#fff}main>header{position:absolute;z-index:99;top:20px;left:16px;color:#07071c;text-transform:uppercase;letter-spacing:4px;font-weight:700}main>nav{position:absolute;z-index:99;top:20px;right:16px}article{padding:30px 0;border-bottom:1px solid #f2f2f0}h1{font-weight:700;letter-spacing:-0.02em;font-size:42px;line-height:1.1;margin-bottom:30px}article>section,article>footer{font-family:Roboto,-apple-system,Arial,Helvetica,sans-serif}.fonts-loaded h2,.fonts-loaded h3,.fonts-loaded h4,.fonts-loaded h5,.fonts-loaded h6,.fonts-loaded footer header,.fonts-loaded footer hr~p{font-family:'Rubik',Roboto,-apple-system,Arial,Helvetica,sans-serif}h3,h4,h5,h6,footer header{letter-spacing:-0.02em;font-weight:700;font-size:24px;line-height:1.3;margin-top:50px;margin-bottom:0px}article>section h2,article>section h3,article>section h4,article>section h5,article>section h6{letter-spacing:-0.02em;font-weight:700;font-size:36px;line-height:1.2;margin-top:50px;margin-bottom:0px}article>section p{font-weight:400;font-size:21px;line-height:1.5;letter-spacing:-.002em;margin-top:30px;margin-bottom:0;-webkit-hyphens:auto;hyphens:auto}article>section a{text-decoration:underline}article>section hr{border:0;padding:0;display:block;width:15%;margin:30px auto;border:0px solid #c2c2dc;border-top: 1px solid #c2c2dc}article>section blockquote{margin:0 0 30px;border-left:3px solid #c2c2dc;padding-left:1em;padding-right:2em}article>section blockquote p{letter-spacing:0.01em;margin-top:1.5em;font-size:1.1em;padding-bottom:3px}article>section ul,article>section ol{margin:15px 0 15px;list-style-position:inside;list-style-type:square}article>section li{padding:0;font-weight:400;font-size:21px;line-height:30px;margin-bottom:8px}article>section ol li{list-style-type:decimal}article>footer{padding:50px 0 0 0}footer header{border-top:1px solid #c2c2dc;padding:16px 0;color:#83838e;font-size:10px;text-transform:uppercase; letter-spacing:1px}footer>a:first-of-type{border-bottom:1px solid #c2c2dc}article>footer hr{border:0;padding:0;display:block;width:15%;margin:16px 0;border:0px solid #c2c2dc;border-top: 1px solid #c2c2dc}article>footer>a{display:block;padding-bottom:32px}article>footer>a h4,article>footer>a p{opacity:.7;-webkit-transition:.2s cubic-bezier(.4,0,.2,1) opacity; transition:.2s cubic-bezier(.4,0,.2,1) opacity}article>footer>a:hover h4,article>footer>a:hover p{opacity:1}article>footer>a h4{font-size:18px;line-height:1.1;padding:0;margin:0}article>footer>a header{padding-bottom:32px}article>footer>a p{font-size:14px;line-height:1.3;font-weight:400;padding:0;margin:18px 0}article>footer>a hr~p{color:#83838e;margin:0;font-weight:400}pre,code,kbd,.fonts-loaded pre,.fonts-loaded code,.fonts-loaded kbd{font-family:Cousine,Menlo,Consolas,Monaco,Courier,monospace;font-size:15px;border-radius:3px;background-color:#e6e6e9;border:1px dotted #c2c2dc}pre,pre>code{margin-top:1.5em;margin-bottom:1.5em;color:#000;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code{padding:1px 5px}pre{padding:8px 12px;overflow-x:scroll}pre>code{border:0;padding-right:0;padding-left:0}kbd{display:inline-block;padding:.25ex .5em}img{width:100%;display:block;margin-top:1.5em;max-width:100%;margin-bottom:1.5em;position:relative;height:auto;min-height:64px}img[data-src]:before{content:'';display:block;position:absolute;top:0;left:0;right:0;bottom:0;background-color:#e6e6e9;border:1px dotted #c2c2dc;-webkit-border-radius:5px;border-radius:5px}img[data-src]:after{content:'Image: "' attr(data-src) '"';display:block;font-size:16px;color:#83838e;position:absolute;top:24px;left:0;right:0;bottom:0;text-align:center}.cursor,.fonts-loaded .cursor{font-family:'Rubik',Roboto,-apple-system,Arial,Helvetica,sans-serif;color:#2196f3}@media only screen and (min-width:768px){body:before{content:'';position:absolute;position:fixed;top:0;left:0;bottom:0;right:0;width:100%;height:100%;-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0);-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:100vw;perspective:100vw;will-change:transform;background-color:#2196f3;background-image:url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2256%22%20height%3D%22100%22%3E%3Cpath%20d%3D%22M28%2066L0%2050L0%2016L28%200L56%2016L56%2050L28%2066L28%20100%22%20fill%3D%22none%22%20stroke-opacity%3D%220.4%22%20stroke%3D%22%23fff%22%20stroke-width%3D%222%22/%3E%3Cpath%20d%3D%22M28%200L28%2034L0%2050L0%2084L28%20100L56%2084L56%2050L28%2034%22%20fill%3D%22none%22%20stroke-opacity%3D%220.2%22%20stroke%3D%22%23fff%22%20stroke-width%3D%222%22/%3E%3C/svg%3E');background-repeat:repeat;z-index:-1}main{padding:56px 32px 32px}main>header{left:32px}main>nav{right:32px}article>footer{font-size:0}article>footer>a{display:inline-block;vertical-align:top;width:45%}article>footer>a:nth-child(1){margin-right:10%}}@media only screen and (min-width:1050px){main{margin:0 auto auto 15%}}@-webkit-keyframes onoff{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@keyframes onoff{0%{opacity:0}50%{opacity:1}100%{opacity:0}}@supports (-webkit-animation-name:flicker){.cursor{-webkit-animation:onoff .9s cubic-bezier(.4,0,.2,1) infinite}}@supports (animation-name:flicker){.cursor{animation:onoff .9s cubic-bezier(.4,0,.2,1) infinite}}amp-user-notification{padding:8px 16px;left:auto;right:16px;bottom:16px;width:auto;border-radius:4px;background:#07071c;color:#fff;font-size:14px;text-align:center;box-shadow:0 15px 30px rgba(7,7,28,.1), 0 4px 12px rgba(7,7,28,.15), 0 2px 6px rgba(7,7,28,.1)}amp-user-notification p{margin:1ex auto}amp-user-notification a,amp-user-notification button{cursor:pointer;display:inline-block;font-weight:700;font-size:12px;padding:8px;background:#fff;color:#07071c;margin-bottom:1ex;border-radius:2px}</style>
  </head>
  <body>
    <amp-font layout="nodisplay" font-family="Rubik" timeout="6000" on-error-add-class="fonts-missing" on-load-add-class="fonts-loaded"></amp-font>
    <main>
      <header>
        <a href="https://amdouglas.com/">A. M. Douglas</a>
      </header>
      <nav>
        <a href="https://amdouglas.com/">Home</a> &bull;
        <a href="https://amdouglas.com/blog/">Archive</a>
      </nav>
      <article>
        <h1>Asynchronous CSS: the Easy Way</h1>
        <section>
          <p>If you've ever looked into asynchronously handling fonts, you've probably read about FilamentGroup's method:</p>
          <pre>
            <code>
&lt;link rel=preload href=/assets/css/main.css as=style onload=this.rel=stylesheet;this.type=text/css;&gt;
            </code>
          </pre>
          <p>It might look like a hack, but this is actually what the <code>link rel=preload</code> spec is intended for.</p>
          <p>The problem is that this will do absolutely nothing in browsers which do not support <code>link rel=preload</code>, and that is a non-trivial number of browsers. You also can't just stick your stylesheet in a <code>noscript</code> element and hope for the best.</p>
          <p>FilamentGroup offers a <a href="https://github.com/filamentgroup/loadCSS">big solution</a> which obviously works well, but I think I prefer a rather more simple approach.</p>
          <pre>
            <code>
var inertCSS = document.querySelectorAll( '[rel="preload"][as="style"]' );
var i = inertCSS.length;
while ( i-- ){
  var css  = document.createElement( 'link' );
  css.rel  = 'stylesheet';
  css.href = inertCSS[i].href;
  ( document.head || document.getElementsByTagName( 'head' )[0] ).appendChild( css );
}
            </code>
          </pre>
          <p>My solution isn't bulletproof. You still need <code>querySelectorAll</code> and you'll need to be careful that you check for unloaded CSS on the <code>DOMContentLoaded</code> event—otherwise, you run the risk of loading your stylesheet(s) twice.</p>
          <p><span class="cursor">&#9608;</span></p>
        </section>
        <footer>
          <a href="https://amdouglas.com/blog/meet-the-new-web-animations-api/">
            <header>Up next</header>
            <section>
              <h4>Meet the new Web Animations API</h4>
              <p>While browser support for the Web Animations API may look rather bleak at the moment, when the other browsers catch up, it will be the sharpest and fastest way to animate anything without resorting to WebGL...</p>
              <hr>
              <p><time datetime="2016-10-28 08:00">28 October 2016</time></p>
            </section>
          </a>
          <a href="https://amdouglas.com/blog/stripe-custom-form-in-vanilla-js/">
            <header>Previously</header>
            <section>
              <h4>Stripe Custom Form in vanilla JavaScript</h4>
              <p>Given that it's coming up to Christmas, there obviously couldn't be a more appropriate time to think about adding or customising an e-commerce experience with your own take on the Stripe form</p>
              <hr>
              <p><time datetime="2016-09-20 21:38">20 September 2016</time></p>
            </section>
          </a>
        </footer>
        <div class="social-share">
          <amp-social-share type="email" width="48" height="36"></amp-social-share>
          <amp-social-share type="twitter" width="48" height="36"></amp-social-share>
          <amp-social-share type="facebook" width="48" height="36" data-attribution="407402372749613"></amp-social-share>
          <amp-social-share type="gplus" width="48" height="36"></amp-social-share>
          <amp-social-share type="linkedin" width="48" height="36"></amp-social-share>
        </div>
      </article>
    </main>
    <amp-user-notification layout="nodisplay" id="amp-user-notification1">
      <p>Cookies are in use on this website.</p>
      <a href="https://amdouglas.com/privacy/">About your privacy</a>
      <button on="tap:amp-user-notification1.dismiss">Accept</button>
    </amp-user-notification>
    <amp-analytics type="googleanalytics">
      <script type="application/json">
        {
          "vars": {
            "account": "UA-70873652-1"
          },
           "triggers": {
            "trackPageview": {
              "on": "visible",
              "request": "pageview"
            }
          }
        }
      </script>
    </amp-analytics>
    <amp-install-serviceworker src="https://amdouglas.com/sw.js" data-iframe-src="https://amdouglas.com/sw-ifr.html" layout="nodisplay"></amp-install-serviceworker>
</body>
</html>
