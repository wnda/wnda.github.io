<!doctype html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,user-scalable=no,shrink-to-fit=no">
    <base href="https://amdouglas.com/">
    <title>Labs: Autoform.js · A. M. Douglas · Leeds, UK</title>
    <link rel="manifest" href="https://amdouglas.com/manifest.json">
    <link rel="prefetch" href="https://amdouglas.com/assets/fonts/Rubik-Regular.woff">
    <link rel="prefetch" href="https://amdouglas.com/assets/fonts/Rubik-Bold.woff">
    <link rel="prefetch" href="https://amdouglas.com/assets/fonts/Rubik-Regular.woff2">
    <link rel="prefetch" href="https://amdouglas.com/assets/fonts/Rubik-Bold.woff2">
    <link rel="canonical" href="https://amdouglas.com/blog/labs-autoform-js/">
    <link rel="publisher" href="https://plus.google.com/+AMDouglasCom">
    <link rel="icon" href="https://amdouglas.com/favicon.ico">
    <meta name="description" content="autoform.js is a vanilla (i.e. no jQuery) JavaScript library which looks for HTML forms in the DOM and automatically handles the submit event via AJAX.">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content="A. M. Douglas">
    <meta name="twitter:url" content="https://amdouglas.com/blog/labs-autoform-js/">
    <meta name="twitter:domain" content="amdouglas.com">
    <meta name="twitter:title" content="Labs: Autoform.js">
    <meta name="twitter:description" content="autoform.js is a vanilla (i.e. no jQuery) JavaScript library which looks for HTML forms in the DOM and automatically handles the submit event via AJAX.">
    <meta name="twitter:image:src" content="https://amdouglas.com/assets/img/favicon-196x196.png">
    <meta property="fb:admins" content="407402372749613">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="A. M. Douglas">
    <meta property="og:title" content="Labs: Autoform.js">
    <meta property="og:description" content="autoform.js is a vanilla (i.e. no jQuery) JavaScript library which looks for HTML forms in the DOM and automatically handles the submit event via AJAX.">
    <meta property="og:locale" content="en_GB">
    <meta property="og:url" content="https://amdouglas.com/blog/labs-autoform-js/">
    <meta property="og:image" content="https://amdouglas.com/assets/img/favicon-196x196.png">
    <meta property="og:image:secure_url" content="https://amdouglas.com/assets/img/favicon-196x196.png">
    <!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
    <style>
      html{-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased;-webkit-font-smoothing:subpixel-antialiased;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-overflow-scrolling:touch;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;touch-action:manipulation;font:normal normal 400 16px/1.2 Roboto,-apple-system,Arial,Helmet,Freesans,sans-serif}html,body{height:100%}*,:before,:after{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;touch-action:manipulation;margin:0;padding:0;border:0;font:inherit}:active,:focus{outline:0}article,footer,header,main,nav,section,video{display:block}a{-webkit-text-decoration-skip:objects;text-decoration:none}button,input,textarea{-webkit-appearance:none;-webkit-border-radius:0;border-radius:0;background:0 0}button,img,video{-webkit-touch-callout:none}button,a,img,video{-webkit-user-select:none;-moz-user-select:none}button,a{color:inherit;cursor:pointer}textarea{resize:none}[disabled]{opacity:.6;cursor:not-allowed}[hidden],video::-webkit-media-controls,video::-webkit-media-controls-play-button,video::-webkit-media-controls-volume-slider,video::-webkit-media-controls-mute-button,video::-webkit-media-controls-timeline,video::-webkit-media-controls-current-time-display{display:none}::-webkit-scrollbar{width:0}::-webkit-scrollbar-thumb{background:#07071c}::-webkit-scrollbar-track{background-color:transparent;background:rgba(0,0,0,0)}::selection{background:#07071c;color:#fff}::-moz-selection{background:#07071c;color:#fff}
    </style>
  </head>
  <body>
    <main>
      <header>
        <a href="https://amdouglas.com/">A. M. Douglas</a>
      </header>
      <nav>
        <a href="https://amdouglas.com/">Home</a> &bull;
        <a href="https://amdouglas.com/blog/">Archive</a>
      </nav>
      <article>
        <h1>Labs: autoform.js</h1>
        <section>
          <p>autoform.js is a vanilla (i.e. not jQuery) JavaScript library which looks for HTML forms in the DOM and automatically handles the submit event via AJAX. </p>
          <p>The name is a deliberate and corny perversion of Fomalhaut, which is the brightest star in the Pisces constellation. So, quite naturally, it has absolutely nothing to do with forms, it's just a word I'm familiar with which could be adapted to include the word &lsquo;form&rsquo;.</p>
          <p>Formalhaut started life as a pair of enormous functions to handle an XMLHttpRequest submission of a form, which originally included validation logic. It worked nicely but some parts were, for all intents and purposes, hard-coded.</p>
          <p>It wasn't until I came to repeat the process of writing logic to submit a form by AJAX without jQuery, or any other abstraction library, that I felt a need to develop something I could reuse. This was not because I didn't value the idea, but rather because my schedule was too busy and much of my work at that time consisted of rewriting or finishing messy/broken/slow websites written by others, where too much already depended on jQuery for it to be removed (and thus I was able to just do <code>$.ajax</code> without a care in the world.</p>
          <p>I've always preferred writing vanilla JavaScript, however. I grew up messing with Perl and &lsquo;DHTML&rsquo; and so when syntactic sugar libraries came along, they merely represented time-sinks for some gains to developer-friendliness (which, being a freelancer, I didn't need, and being me, didn't want) and for losses w.r.t. performance. jQuery was of course very helpful in fast-moving projects where browser-compatibility was not a straightforward problem to solve, but that, for me, is its only use.</p>
          <p>jQuery's simplicity has naturally given rise to a huge and scattered eco-system of &lsquo;plugins&rsquo;, many of which make sophisticated animations and complex web application UIs almost trivial to build. It wasn't jQuery that ushered in the age of the single-page application—I'm sure you can remember those awful Adobe Flash websites where you couldn't copy and paste anything and links couldn't be opened in new tabs, and so on).</p>
          <p>However, if the JavaScript community as a whole gained something from jQuery, besides a good lesson in how to design a complex library, the community must surely have seen the value of having reusable plugins that could effectively componentise web development. Sure enough, the two JavaScript frameworks/libraries on everybody's lips these days are React and Polymer—both of which are designed to enable developers to build composable, reusable snap-ins, enabling websites which can be put together almost automatically.</p>
          <p>While I dislike both React and Polymer for a number of reasons,* the fundamental idea of reusing solid libraries enables developers to move faster. To that end, I've been writing JavaScript libraries whenever I have been unable to find one that did what I wanted it to do, or whenever the ones available were: </p>
          <ul>
            <li>over-engineered</li>
            <li>slow</li>
            <li>huge</li>
            <li>obtuse</li>
            <li>broken</li>
            <li>all of the above</li>
          </ul>
          <p>So far, I've written libs to animate DOM elements in three dimensions responding to the pointer; to display an EU-required cookie warning; to lazyload images and CSS background-images based on viewport visibility; and to trivialise the creation of tabs/tabbed sections of content. Now, to that list, I append my form auto-AJAXifier.</p>
          <p>Unlike my other libraries, formalhaut requires no configuration (at the moment). This is largely because the library checks the DOM for forms and configures itself based on attributes specified on the form. This made sense initially, because the <code>content-type</code>, <code>accept-charset</code>, <code>HTTP method</code>, and the URL being targeted, are all specifiable using the valid HTML attributes: <code>enctype=""</code>, <code>accept-charset=""</code>, <code>method=""</code>, and <code>action=""</code> respectively.</p>
          <p>Formalhaut currently works as a blunt, everything-or-nothing drop-in. Include it at the bottom of the <code>body</code>, make sure your forms have the right attributes and you're done. Your form submissions will be interrupted and sent via fetch/XHR instead.</p>
          <p>The beauty of the library is that, by using attributes like <code>method</code> and <code>enctype</code>, we can gracefully degrade to native form submit behaviour if the user doesn't have JavaScript switched on, so a bit of work on your router will enable both AJAX and native form submission handling.</p>
          <p>So how does it work? Let's have a look at the library's anatomy. The library is exposed as a global object which, when the <code>init()</code> is called, finds all of the forms for a given <code>document</code> and adds the formalhaut submit event handler.</p>
          <pre>
            <code>
e.preventDefault();
var form   = ( e.target || this );
var query  =
  (function(){
    var inputs = form.querySelectorAll( settings.selector ),
        i      = inputs.length,
        j      = 0,
        str    = [];

    for( ; i &gt; j; j++ ){
      var q = (
        !!inputs[j].getAttribute( 'name' ) &amp;&amp; !!inputs[j].value ?
        inputs[j].getAttribute( 'name' ) + '=' + inputs[j].value :
        !1
      );

      !!q &amp;&amp; str.push( q );
    }

    if( !str.length ){
      console.error( 'Error in constructing query: no named input' );
      return false;
    }
    else {
      return str.join( '&amp;' );
    }
  }());

!!query &amp;&amp; formalhaut.sendForm( query, form );
            </code>
          </pre>
          <p>This code would be considered terse by most JS developers used to plastic-packed frameworks with easy-open, &ldquo;tear here&rdquo; APIs, but that&rsquo;s not what I aim to create. My snippets/libraries are not intended to replace a framework in any big web app; they're designed to be drop-ins for static sites and generic marketing sites where a minimum of dynamic functionality is desirable.</p>
          <p>It's very crude but it saves plenty of time if you're just working on simple sites for local businesses (as I often do because I prefer freelancing over working for some big corporation's advertising/content-marketing machine) and you want to achieve a nice and simple user experience without including jQuery just for <code>$.ajax</code>.</p>
          <p>My plan to improve the library will involve adding the ability to ignore form attributes and to supply configuration objects instead. Forms themselves will not be grabbed as one NodeList/HTMLCollection using <code>document.forms</code> (though this will be the default behaviour) and instead it will be possible to initialise multiple instances of formalhaut to target different forms, or groups of forms, based on CSS selectors.</p>
          <p>You can see view the source code here: <br>
            <a href="https://github.com/wnda/formalhaut">https://github.com/wnda/autoform/</a>
          </p>
          <p><span class="cursor">&#9608;</span></p>
        </section>
        <footer>
          <a href="https://amdouglas.com/blog/why-the-new-fetch-api-is-broken/">
            <header>Up next</header>
            <section>
              <h4>Why the New fetch API is Broken</h4>
              <p>There is probably no DOM API more loathed than the XMLHttpRequest, but is the hatred really justified? It probably was when web browsers did not implement it consistently...</p>
              <hr>
              <p><time datetime="2016-08-18 20:59">18 August 2016</time></p>
            </section>
          </a>
          <a href="https://amdouglas.com/blog/amp-full-circle/">
            <header>Previously</header>
            <section>
              <h4>AMP: Full Circle</h4>
              <p>A few months ago I declared that AMP-HTML was of little use to a blog, especially one has finely-tuned for performance as mine, which serves nothing but text, SVG and woff2 fonts.</p>
              <hr>
              <p><time datetime="2016-08-12 20:23">12 August 2016</time></p>
            </section>
          </a>
        </footer>
      </article>
    </main>
    <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "NewsArticle",
        "mainEntityOfPage": "https://amdouglas.com/blog/labs-autoform-js/",
        "headline": "Labs: Autoform.js",
        "datePublished": "2016-08-14T22:49:22+00:00",
        "dateModified": "2016-08-14T22:49:22+00:00",
        "description": "autoform.js is a vanilla (i.e. no jQuery) JavaScript library which looks for HTML forms in the DOM and automatically handles the submit event via AJAX.",
        "author": {
          "@type": "Person",
          "name": "A. M. Douglas"
        },
        "publisher": {
          "@type": "Organization",
          "name": "A. M. Douglas",
          "logo": {
            "@type": "ImageObject",
            "url": "https://amdouglas.com/assets/img/apple-touch-icon-60x60.png",
            "width": 60,
            "height": 60
          }
        },
        "image": {
          "@type": "ImageObject",
          "url": "https://amdouglas.com/assets/img/apple-touch-icon-60x60.png",
          "height": 60,
          "width": 60
        }
      }
    </script>
    <!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--><!--[if IE]><script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/2014.01.31/classList.min.js"></script><![endif]-->
    <script async defer src="https://amdouglas.com/assets/js/article.js"></script>
  </body>
</html>
